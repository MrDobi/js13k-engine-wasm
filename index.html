<!DOCTYPE html>
<html lang="en">
<head>
<script type="module">
import { memory, u, c } from "./build/release.js";
const canvas = document.querySelector("canvas");
canvas.width = canvas.height = 20;
const ctx = canvas.getContext("2d");
const image = ctx.createImageData(canvas.width, canvas.height);

// init screen size
// --memoryBase
// demos todo: snake, flappy birds, tetris, racing, mario, pharaoh, knight and merchants
// https://www.assemblyscript.org/examples/interference.html#interference-example
// https://github.com/ttulka/2d-videogame-in-assemblyscript

(function d() {
    requestAnimationFrame(d);
    // better slice (camera, size)
    image.data.set(new Uint8Array(memory.buffer).slice(0, 20 * 20 * 4));
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.putImageData(image, 0, 0);
})();

let lastUpdate = performance.now();
setInterval(() => {
    let now = performance.now(), diff = now - lastUpdate;
    lastUpdate = now;
    u(parseInt(diff))
}, 150);

// touch not working yet :<
document.addEventListener("mousedown", e => c(e.clientX, e.clientY, true));
document.addEventListener("mousemove", e => c(e.clientX, e.clientY, true));
document.addEventListener("mouseup", e => c(e.clientX, e.clientY, false));
</script>
</head>
<body style="margin:0;overflow:hidden;background:#444"><canvas style="image-rendering:pixelated;width:100vmin;margin:0 auto;display:block"></body></html>
